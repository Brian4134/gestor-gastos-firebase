<!-- Modal para Nueva Transacción -->
<div class="modal fade" id="modalNuevaTransaccion" tabindex="-1" aria-labelledby="modalNuevaTransaccionLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="modalNuevaTransaccionLabel">
                    <i class="bi bi-plus-circle me-2"></i>Registrar Nueva Transacción
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form action="/crear" method="POST" id="formNuevaTransaccion">
                    <div class="mb-3">
                        <label for="tipo" class="form-label">Tipo</label>
                        <select name="tipo" id="tipo" class="form-select" required>
                            <option value="gasto">Gasto</option>
                            <option value="ingreso">Ingreso</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="categoria" class="form-label">Categoría</label>
                        <select name="categoria" id="categoria" class="form-select" required>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="descripcion" class="form-label">Descripción</label>
                        <input type="text" name="descripcion" id="descripcion" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="monto" class="form-label">Monto (S/)</label>
                        <input type="number" step="0.01" name="monto" id="monto" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="fecha" class="form-label">Fecha</label>
                        <input type="date" name="fecha" id="fecha" class="form-control" required>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-check-circle me-1"></i>Guardar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Script para actualizar categorías según el tipo seleccionado
    document.addEventListener('DOMContentLoaded', function () {
        const tipoSelect = document.getElementById('tipo');
        const categoriaSelect = document.getElementById('categoria');
        const fechaInput = document.getElementById('fecha');

        const categorias = {
            gasto: ['Alimentación', 'Transporte', 'Vivienda', 'Entretenimiento', 'Salud', 'Educación', 'Otros'],
            ingreso: ['Salario', 'Freelance', 'Inversiones', 'Otros Ingresos']
        };

        function updateCategorias() {
            const tipo = tipoSelect.value;
            categoriaSelect.innerHTML = '';

            categorias[tipo].forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categoriaSelect.appendChild(option);
            });
        }

        // Establecer fecha actual por defecto
        function setFechaActual() {
            const today = new Date().toISOString().split('T')[0];
            fechaInput.value = today;
        }

        tipoSelect.addEventListener('change', updateCategorias);

        // Inicializar cuando se abre el modal
        const modal = document.getElementById('modalNuevaTransaccion');
        modal.addEventListener('shown.bs.modal', function () {
            updateCategorias();
            setFechaActual();
            // Limpiar el formulario
            document.getElementById('formNuevaTransaccion').reset();
            updateCategorias();
            setFechaActual();
        });

        // Inicializar al cargar la página
        updateCategorias();
        setFechaActual();
    });
</script>